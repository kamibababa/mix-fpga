BYTE	EQU	1(4:4)
EXP	EQU	1:1
Q	EQU	BYTE/2
BUFFER	EQU	2000
	ORIG	1000
BEGIN	IN	BUFFER(16)
	JBUS	*(16)
	LDA	BUFFER
	LDX	BUFFER+1
	NUM
	STA	IN1
	LDA	BUFFER+2
	LDX	BUFFER+3
	NUM
	STA	IN2
	LDA	IN1
	JOV	*
	ADD	IN2(6)
	STA	BUFFER+4
	JNOV    ADDOK
	LDA	OVERF
	STA	BUFFER+5	
ADDOK   LDA	IN1
	JOV	*
	SUB	IN2(6)
	STA	BUFFER+6
	JNOV    SUBOK
	LDA	OVERF
	STA	BUFFER+7
SUBOK   LDA	IN1
	JOV	*
	MUL	IN2(6)
	STA	BUFFER+8
	JNOV	MULOK
	LDA	OVERF
	STA	BUFFER+9
MULOK   LDA	IN1
	JOV	*
	DIV	IN2(6)
	STA	BUFFER+10
	JNOV	DIVOK
	LDA	OVERF
	STA	BUFFER+11
DIVOK	LDA	PASS
	STA	BUFFER+12
	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FADD
	STA	ACC
	LDA	BUFFER+5
	CMPA	BUFFER+13
	JE	OVERA
	LDA	BUFFER+4
	CMPA	ACC
	JE      WRITEA
	LDA	FAIL
	STA	BUFFER+12
	JMP	WRITEA
OVERA   LDA	BLANK
	STA	BUFFER+4
	JMP	TESTSUB
WRITEA	LDA	BUFFER+4
	CHAR
	STA	BUFFER+4
	STX	BUFFER+5
	JANN	TESTSUB
	LDA	BUFFER+5
	DECA	30
	STA	BUFFER+5
TESTSUB	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FSUB
	STA	ACC
	LDA	BUFFER+7
	CMPA	BUFFER+13
	JE	OVERS
	LDA	BUFFER+6
	CMPA	ACC
	JE      WRITES
	LDA	FAIL
	STA	BUFFER+12
	JMP	WRITES
OVERS   LDA	BLANK
	STA	BUFFER+6
	JMP	TESTMUL
WRITES	LDA	BUFFER+6
	CHAR
	STA	BUFFER+6
	STX	BUFFER+7
	JANN	TESTMUL
	LDA	BUFFER+7
	DECA	30
	STA	BUFFER+7
TESTMUL	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FMUL
	STA	ACC
	LDA	BUFFER+9
	CMPA	BUFFER+13
	JE	OVERM
	LDA	BUFFER+8
	CMPA	ACC
	JE      WRITEM
	LDA	FAIL
	STA	BUFFER+12
	JMP	WRITEM
OVERM   LDA	BLANK
	STA	BUFFER+8
	JMP	TESTDIV
WRITEM	LDA	BUFFER+8
	CHAR
	STA	BUFFER+8
	STX	BUFFER+9
	JANN	TESTDIV
	LDA	BUFFER+9
	DECA	30
	STA	BUFFER+9
TESTDIV	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FDIV
	STA	ACC
	LDA	BUFFER+11
	CMPA	BUFFER+13
	JE	OVERD
	LDA	BUFFER+10
	CMPA	ACC
	JE      WRITED
	LDA	FAIL
	STA	BUFFER+12
	JMP	WRITED
OVERD   LDA	BLANK
	STA	BUFFER+10
	JMP	TESTE
WRITED	LDA	BUFFER+10
	CHAR
	STA	BUFFER+10
	STX	BUFFER+11
	JANN	TESTE
	LDA	BUFFER+11
	DECA	30
	STA	BUFFER+11
TESTE	LDA	BLANK
	STA	BUFFER+13
	OUT	BUFFER(19)
	JMP 	BEGIN
IN1	CON	0
IN2	CON	0
FSUB	STA	TEMP
	LDAN	TEMP
FADD	STJ	EXIT2
	JOV	*
	STA	TEMP
	LDX	ACC
	CMPA	ACC(EXP)
	JGE	1F
	STX	FU(0:4)
	LD2	ACC(EXP)
	STA	FV(0:4)
	LD1N	TEMP(EXP)
	JMP	4F
1H	STA	FU(0:4)
	LD2	TEMP(EXP)
	STX	FV(0:4)
	LD1N	ACC(EXP)
4H	INC1	0,2
5H	LDA	FV
	ENTX	0
	SRAX	0,1
6H	ADD	FU
	JOV	N4
	JXZ	NORM
	LD1	FV(0:1)
	JAP	1F
	J1N	N2
	JMP	2F
1H	J1P	N2
2H	SRC	5
	DECX	1
	STA	TEMP
	STA	HALF(0:0)
	LDAN	TEMP
	ADD	HALF
	ADD	HALF
	SRC	5
	JMP	N2
HALF	CON	1//2
FU	CON	0
FV	CON	0
FMUL	STJ	EXIT2
	JOV	*
	STA	TEMP
	LDX	ACC
	STX	FU(0:4)
	LD1	TEMP(1:1)
	LD2	ACC(1:1)
	INC2	-32,1
	SLA	1
	MUL	FU
	JMP	NORM
FDIV	STJ	EXIT2
	JOV	*
	STA	TEMP
	STA	FV(0:4)
	LD1	TEMP(EXP)
	LD2	ACC(EXP)
	DEC2	-Q,1
	ENTX	0
	LDA	ACC
	SLA	1
	CMPA	FV(1:5)
	JL	*+3
	SRA	1
	INC2	1
	DIV	FV
	JNOV	NORM
	JMP	EXPOF
NORM	JAZ	ZRO
N2	CMPA	=0=(1:1)
	JNE	N5
N3	SLAX	1
	DEC2	1
	JMP	N2
N4	ENTX	1
	SRC	1
	INC2	1
N5	CMPA	=BYTE/2=(5:5)
	JL	N6
	JG	5F
	JXNZ	5F
	STA	TEMP
	LDX	TEMP(4:4)
	JXO	N6
5H	STA	*+1(0:0)
	INCA	BYTE	
	JOV	N4
N6	J2N	EXPOF
N7	ENTX	0,2
	SRC	1
ZRO	DEC2	BYTE
8H	STA	ACC
EXITF	J2N	EXIT2
EXPOF	LDA	OVERF
	STA	BUFFER+13
EXIT2	JMP	*	
OVERF	ALF	"OVER "
FAIL	ALF	"FAIL "
PASS	ALF	"PASS "
BLANK	ALF	"     " 
TEMP	CON	0
ACC	CON	0
	END	BEGIN

