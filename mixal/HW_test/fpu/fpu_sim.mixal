BYTE	EQU	1(4:4)
EXP	EQU	1:1
Q	EQU	BYTE/2
BUFFER	EQU	2000
	ORIG	1000
BEGIN	IN	BUFFER(19)
	JBUS	*(10)
	LDA	BUFFER
	LDX	BUFFER+1
	NUM
	STA	IN1
	LDA	BUFFER+2
	LDX	BUFFER+3
	NUM
	STA	IN2
TESTA	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FADD
WRITEA	CHAR
	STA	BUFFER+4
	STX	BUFFER+5
	JANN	SIGNA
	LDA	BUFFER+5
	DECA	30
	STA	BUFFER+5
SIGNA	LDA	BUFFER+13
	CMPA	OVERF
	JNE	TESTS
	LDA	BUFFER+4
        LDA	BLANK
	STA	BUFFER+5
TESTS	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FSUB
WRITES	CHAR
	STA	BUFFER+6
	STX	BUFFER+7
	JANN	SIGNS
	LDA	BUFFER+7
	DECA	30
	STA	BUFFER+7
SIGNS	LDA	BUFFER+13
	CMPA	OVERF
	JNE	TESTM
	LDA	BUFFER+6
        LDA	BLANK
	STA	BUFFER+7
TESTM	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FMUL
WRITEM	CHAR
	STA	BUFFER+8
	STX	BUFFER+9
	JANN	SIGNM
	LDA	BUFFER+9
	DECA	30
	STA	BUFFER+9
SIGNM	LDA	BUFFER+13
	CMPA	OVERF
	JNE	TESTD
	LDA	BUFFER+8
        LDA	BLANK
	STA	BUFFER+9
TESTD	LDA	BLANK
	STA	BUFFER+13
	LDA	IN1
	STA	ACC
	LDA	IN2
	JMP	FDIV
WRITED	CHAR
	STA	BUFFER+10
	STX	BUFFER+11
	JANN	SIGND
	LDA	BUFFER+11
	DECA	30
	STA	BUFFER+11
SIGND	LDA	BUFFER+13
	CMPA	OVERF
	JNE	TESTE
	LDA	BUFFER+10
        LDA	BLANK
	STA	BUFFER+11
TESTE	LDA	BLANK
	STA	BUFFER+13
	OUT	BUFFER(19)
	JMP 	BEGIN
IN1	CON	0
IN2	CON	0
FSUB	STA	TEMP
	LDAN	TEMP
FADD	STJ	EXIT2
	JOV	*
	STA	TEMP
	LDX	ACC
	CMPA	ACC(EXP)
	JGE	1F
	STX	FU(0:4)
	LD2	ACC(EXP)
	STA	FV(0:4)
	LD1N	TEMP(EXP)
	JMP	4F
1H	STA	FU(0:4)
	LD2	TEMP(EXP)
	STX	FV(0:4)
	LD1N	ACC(EXP)
4H	INC1	0,2
5H	LDA	FV
	ENTX	0
	SRAX	0,1
6H	ADD	FU
	JOV	N4
	JXZ	NORM
	LD1	FV(0:1)
	JAP	1F
	J1N	N2
	JMP	2F
1H	J1P	N2
2H	SRC	5
	DECX	1
	STA	TEMP
	STA	HALF(0:0)
	LDAN	TEMP
	ADD	HALF
	ADD	HALF
	SRC	5
	JMP	N2
HALF	CON	1//2
FU	CON	0
FV	CON	0
FMUL	STJ	EXIT2
	JOV	*
	STA	TEMP
	LDX	ACC
	STX	FU(0:4)
	LD1	TEMP(1:1)
	LD2	ACC(1:1)
	INC2	-32,1
	SLA	1
	MUL	FU
	JMP	NORM
FDIV	STJ	EXIT2
	JOV	*
	STA	TEMP
	STA	FV(0:4)
	LD1	TEMP(EXP)
	LD2	ACC(EXP)
	DEC2	-Q,1
	ENTX	0
	LDA	ACC
	SLA	1
	CMPA	FV(1:5)
	JL	*+3
	SRA	1
	INC2	1
	DIV	FV
	JNOV	NORM
	JMP	EXPOF
NORM	JAZ	ZRO
N2	CMPA	=0=(1:1)
	JNE	N5
N3	SLAX	1
	DEC2	1
	JMP	N2
N4	ENTX	1
	SRC	1
	INC2	1
N5	CMPA	=BYTE/2=(5:5)
	JL	N6
	JG	5F
	JXNZ	5F
	STA	TEMP
	LDX	TEMP(4:4)
	JXO	N6
5H	STA	*+1(0:0)
	INCA	BYTE	
	JOV	N4
N6	J2N	EXPOF
N7	ENTX	0,2
	SRC	1
ZRO	DEC2	BYTE
8H	STA	ACC
EXITF	J2N	EXIT2
EXPOF	LDA	OVERF
	STA	BUFFER+13
EXIT2	JMP	*	
OVERF	ALF	"OVER "
FAIL	ALF	"FAIL "
PASS	ALF	"PASS "
BLANK	ALF	"     " 
TEMP	CON	0
ACC	CON	0
	END	BEGIN

